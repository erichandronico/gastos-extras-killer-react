# Queries Sql para Importar Dimensiones

## Means desde FHO
```sql
SELECT m.[name]
      ,m.[string]
      ,m.[type]
      ,m.[status]
      ,gr.[name] as rule_name
      ,m.[hardware_type]
      ,m.[pump]
      ,m.[employee_type]
      ,m.[plate]
      ,mo.name as modelo
      ,m.[YEAR]
      ,m.[capacity]
      ,m.[consumption]
      ,m.[odometer]
      ,m.[cust_id]
      ,m.[address]
      ,f.name as fleet_name
      ,d.name as dept_name
      ,m.[acctyp]
      ,m.[available_amount]
      ,CONVERT( varchar(19), m.update_timestamp, 120) as update_timestamp
      ,m.[fcc_bos_cleared]
      ,m.[use_pin_code]
      ,m.[pin_code]
      ,m.[auth_pin_from]
      ,m.[nr_pin_retries]
      ,m.[block_if_pin_retries_fail]
      ,m.[opos_prompt_for_plate]
      ,m.[opos_prompt_for_odometer]
      ,m.[do_odo_reasonability_check]
      ,m.[max_odo_delta_allowed]
      ,m.[nr_odo_retries]
      ,m.[driver_id_type_required]
      ,m.[price_list_id]
      ,m.[auttyp]
      ,m.[engine_hours]
      ,m.[original_engine_hours]
      ,m.[target_engine_hours]
      ,m.[price_list]
      ,m.[opos_prompt_for_engine_hours]
      ,m.[start_odometer]
      ,m.[consumption2]
      ,m.[is_burned]
      ,m.[viu_serial]
      ,m.[allow_id_replacement]
      ,m.[num_of_strings]
      ,m.[string2]
      ,m.[string3]
      ,m.[string4]
      ,m.[string5]
      ,m.[opos_plate_check_type]
      ,m.[nr_plate_retries]
      ,m.[block_if_plate_retries_fail]
      ,CONVERT( varchar(19), m.last_used, 120) as last_used
      ,m.[disable_viu_two_stage]
      ,m.[prompt_always_for_viu]
      ,m.[expire]
      ,m.[expire_date]
      ,m.[do_eh_reasonability_check]
      ,m.[max_eh_delta_allowed]
      ,m.[nr_eh_retries]
      ,m.[reject_if_eh_check_fails]
      ,m.[reject_if_odm_check_fails]
      ,m.[route_prompt]
      ,m.[pressure_level]
      ,m.[attendant_required]
      ,m.[prompt_for_jobcode]
  FROM [HO_DATA].[dbo].[means] m
  join [HO_DATA].[dbo].[fleets] f on  m.fleet_id = f.id and f.status > 0
  join [HO_DATA].[dbo].[depts] d on d.fleet_id = m.fleet_id and d.id = m.dept_id and d.status > 0
  left outer join [HO_DATA].[dbo].[model] mo on mo.id = m.model_id
  left outer join [HO_DATA].[dbo].[group_rules] gr on gr.id = m.[rule]
  where m.status > 0 and type in ( 1, 2, 3, 4 )
  ```

  ## Fleets dede FHO

```sql
SELECT [name]
      ,[status]
      ,[code]
      ,[address]
      ,[phone]
      ,[fax]
      ,[email]
      ,[contact]
      ,[acctyp]
      ,[available_amount]
      ,[min_allowed]
      ,CONVERT( varchar(19), update_timestamp, 120) as update_timestamp
      ,[use_pin_code]
      ,[auth_pin_from]
      ,[nr_pin_retries]
      ,[block_if_pin_retries_fail]
      ,[opos_prompt_for_plate]
      ,[opos_prompt_for_odometer]
      ,[do_odo_reasonability_check]
      ,[max_odo_delta_allowed]
      ,[nr_odo_retries]
      ,[price_list_id]
      ,[use_rule_limit]
      ,[max_rules]
      ,[max_group_rules]
      ,[contact2]
      ,[contact3]
      ,[city]
      ,[state]
      ,[zip]
      ,[sales_person]
      ,[eft_id]
      ,[wex_renewal_fee]
      ,[wex_billing_fee_56]
      ,[on_line_fee_68]
      ,[line_of_credit]
      ,[sent_to_fho]
      ,[sent_to_dho]
      ,[opos_prompt_for_engine_hours]
      ,[address2]
      ,[user_data1]
      ,[user_data2]
      ,[user_data3]
      ,[user_data4]
      ,[user_data5]
      ,[last_sequence]
      ,[sent_to_olic]
      ,[disable_viu_two_stage]
      ,[prompt_always_for_viu]
      ,[discovered]
      ,[do_eh_reasonability_check]
      ,[max_eh_delta_allowed]
      ,[nr_eh_retries]
      ,[reject_if_eh_check_fails]
      ,[mobile]
      ,[companyid]
      ,[reject_if_odm_check_fails]
      ,[single_fuel]
  FROM [HO_DATA].[dbo].[fleets] where id > 900000000 and status > 0
```

## Depts desde FHO

```sql
SELECT d.[name]
      ,f.code as fleet_code
      ,d.[status]
      ,d.[code]
      ,d.[address]
      ,d.[phone]
      ,d.[fax]
      ,d.[email]
      ,d.[contact]
      ,d.[use_pin_code]
      ,d.[auth_pin_from]
      ,d.[nr_pin_retries]
      ,d.[block_if_pin_retries_fail]
      ,d.[opos_prompt_for_plate]
      ,d.[opos_prompt_for_odometer]
      ,d.[do_odo_reasonability_check]
      ,d.[max_odo_delta_allowed]
      ,d.[nr_odo_retries]
      ,d.[price_list_id]
      ,d.[black_white_type]
      ,d.[opos_prompt_for_engine_hours]
      ,d.[address2]
      ,d.[city]
      ,d.[state]
      ,d.[zip]
      ,d.[user_data1]
      ,d.[user_data2]
      ,d.[user_data3]
      ,d.[user_data4]
      ,d.[user_data5]
      ,d.[disable_viu_two_stage]
      ,d.[prompt_always_for_viu]
      ,d.[discovered]
      ,d.[do_eh_reasonability_check]
      ,d.[max_eh_delta_allowed]
      ,d.[nr_eh_retries]
      ,d.[reject_if_eh_check_fails]
      ,d.[reject_if_odm_check_fails]
  FROM [HO_DATA].[dbo].[depts] d
  join [HO_DATA].[dbo].[fleets] f on f.id = d.fleet_id
  where d.id > 200000000 and d.status > 0 and f.status > 0
  ```

## Models desde FHO
```sql
SELECT 
       m.[name]
      ,m.[status]
      ,c.[name] as company_name
      ,m.[capacity]
      ,m.[consumption]
      ,m.[consumption2]
      ,m.[description]
      ,class.[description] class_description
  FROM [HO_DATA].[dbo].[model] m    
  LEFT OUTER JOIN [HO_DATA].[dbo].[company] c on c.id = m.company_id
  LEFT OUTER JOIN [HO_DATA].[dbo].[equipment_class] class on class.id = m.class_id
  WHERE m.status > 0
  ```

  ## Refuels desde FHO

  ```sql

  SELECT TOP (1000) 
    t.[shift_id]
    ,CONVERT(VARCHAR(19), t.[timestamp], 120) [timestamp]
    ,t.[id]
    ,CONVERT(VARCHAR(19), t.[date], 120) [date]
    ,CONVERT(VARCHAR(19), t.[time], 120) [time]
    ,t.[type]
    ,t.[pump]
    ,t.[nozzle]
    ,t.[product_code]
    ,t.[sale]
    ,t.[ppv]
    ,t.[quantity]
    ,t.[density]
    ,t.[temperature]
    ,t.[tag]
    ,t.[tank_id]
    ,t.[track1]
    ,t.[track2]
    ,t.[odometer]
    ,t.[engine_hours]
    ,t.[fleet_id]
    ,f.[name] [fleet_name]
    ,f.[code] [fleet_code]
    ,t.[mean_id]
    ,m.[name] [mean_name]
    ,t.[plate]
    ,CASE
    WHEN m.type = 1 THEN 'ATD'
    WHEN m.type = 2 then 'TAG'
    WHEN m.type = 3 THEN 'VIS'
    WHEN m.type = 4 THEN 'DRV'
    WHEN m.type is NULL THEN '-' END AS [mean_type]
    ,t.[coupon_id]
    ,t.[external_tran_id]
    ,t.[external_auth_number]
    ,t.[trx_seq_no]
    ,t.[fcc_bos_cleared]
    ,t.[tank_name]
    ,t.[mean_name]
    ,d.[code] [dept_code]
    ,d.[name] [dept_name]
    ,t.[product_name]
    ,t.[pump_id]
    ,t.[nozzle_id]
    ,t.[driver_object_id]
    ,t.[driver_name]
    ,t.[stn_id]
    ,t.[txn_calc_status]
    ,t.[sent_to_dho]
    ,t.[sent_to_fho]
    ,t.[counter2]
    ,t.[counter3]
    ,t.[timer2]
    ,t.[timer3]
    ,t.[previous_odometer]
    ,t.[previous_engine_hours]
    ,t.[hose_number]
    ,t.[cash_customer_id]
    ,t.[total_price_after_discount]
    ,t.[receipt_id]
    ,t.[entry_type]
    ,t.[changed_trans_flag]
    ,t.[billing_sale]
    ,t.[pir_payment_type]
    ,t.[pir_trans_date_time]
    ,t.[pir_refuel_method]
    ,CONVERT(VARCHAR(19), t.[start_flow], 120) [start_flow]
    ,CONVERT(VARCHAR(19), t.[end_flow], 120) [end_flow]
    ,t.[night_shift]
    ,t.[pir_additional_plate]
    ,t.[pir_additional_tag]
    ,t.[pir_additional_type]
    ,t.[proxy_id]
    ,t.[base_price]
    ,t.[price_list_id]
    ,t.[base_product_percent]
    ,t.[aux1_eh]
    ,t.[aux2_eh]
    ,t.[totalizer_vol]
    ,t.[preset_volume]
    ,t.[preset_money]
    ,t.[last_running_volume]
    ,t.[refund]
    ,t.[authorization_mode]
    ,t.[sent_to_client]
    ,t.[auth_type]
    ,t.[aa_mods]
    ,t.[coupon_num]
    ,t.[authorized_user_id]
    ,t.[totalizer_original]
    ,t.[truckstop_invoice_num]
    ,t.[tail_id]
    ,t.[pressure_level]
    ,t.[totalizer_money]
    ,t.[attendant_object_id]
    ,t.[attendant_name]
    ,t.[device_id]
    ,t.[voucher_id]
    FROM [HO_DATA].[dbo].[transactions] t
     join [HO_DATA].[dbo].[fleets] f on f.id = t.fleet_id
     join [HO_DATA].[dbo].[means] m on m.id = t.mean_id
     join [HO_DATA].[dbo].[depts] d on d.id = m.dept_id
    where f.status > 0 and m.status > 0 and d.status > 0
    order by [timestamp] desc
  ```